{"version":3,"sources":["../../../source/lib/worksheet/optsValidator.js"],"names":["types","require","optsTypes","getObjItem","obj","key","returnObj","levels","split","length","thisLevelKey","shift","e","validator","val","type","sizes","Object","keys","paperSize","indexOf","TypeError","join","pageOrder","validate","orientation","positiveUniversalMeasure","cellComment","printError","pane","paneState","parseFloat","parseInt","traverse","o","keyParts","func","i","thisKeyParts","concat","thisKey","thisType","thisItem","module","exports","opts"],"mappings":";;;;AAAA,IAAMA,QAAQC,QAAQ,mBAAR,CAAd;;AAEA,IAAMC,YAAY;AACjB,YAAW;AACV,YAAU,OADA;AAEV,YAAU,OAFA;AAGV,YAAU,OAHA;AAIV,UAAQ,OAJE;AAKV,WAAS,OALC;AAMV,SAAO;AANG,EADM;AASjB,iBAAgB;AACf,sBAAoB,SADL;AAEf,oBAAkB,SAFH;AAGf,oBAAkB,SAHH;AAIf,mBAAiB;;AAJF,EATC;AAgBjB,cAAa;AACZ,mBAAiB,SADL;AAEZ,kBAAgB,eAFJ;AAGZ,YAAU,SAHE;AAIZ,WAAS,SAJG;AAKZ,YAAU,aALE;AAMZ,qBAAmB,SANP;AAOZ,iBAAe,SAPH;AAQZ,gBAAc,SARF;AASZ,mBAAiB,SATL;AAUZ,iBAAe,aAVH;AAWZ,eAAa,YAXD;AAYZ,iBAAe,4BAZH;AAaZ,eAAa,YAbD;AAcZ,gBAAc,4BAdF;AAeZ,WAAS,SAfG;AAgBZ,wBAAsB,SAhBV;AAiBZ,wBAAsB,SAjBV;AAkBZ,iBAAe;AAlBH,EAhBI;AAoCjB,iBAAgB;AACf,gBAAc,QADC;AAEf,gBAAc,QAFC;AAGf,iBAAe,QAHA;AAIf,iBAAe,QAJA;AAKf,eAAa,QALE;AAMf,eAAa,QANE;AAOf,sBAAoB,SAPL;AAQf,oBAAkB,SARH;AASf,sBAAoB,SATL;AAUf,kBAAgB;AAVD,EApCC;AAgDjB,cAAa;AACZ,UAAQ;AACP,iBAAc,MADP;AAEP,YAAS,YAFF;AAGP,kBAAe,IAHR;AAIP,aAAU,IAJH;AAKP,aAAU;AALH,GADI;AAQZ,iBAAe,IARH;AASZ,oBAAkB,IATN;AAUZ,iBAAe,IAVH;AAWZ,eAAa,IAXD;AAYZ,qBAAmB,IAZP;AAaZ,6BAA2B,IAbf;AAcZ,mBAAiB;AAdL,EAhDI;AAgEjB,gBAAe;AACd,kBAAgB,IADF;AAEd,kBAAgB,IAFF;AAGd,qBAAmB,IAHL;AAId,sBAAoB,IAJN;AAKd,qBAAmB,IALL;AAMd,qBAAmB,IANL;AAOd,iBAAe,IAPD;AAQd,cAAY,IARE;AASd,gBAAc;AATA,EAhEE;AA2EjB,oBAAmB;AAClB,gBAAc,IADI;AAElB,mBAAiB,IAFC;AAGlB,eAAa,IAHK;AAIlB,iBAAe,IAJG;AAKlB,mBAAiB,IALC;AAMlB,gBAAc,IANI;AAOlB,eAAa,IAPK;AAQlB,mBAAiB,IARC;AASlB,sBAAoB,IATF;AAUlB,gBAAc,IAVI;AAWlB,aAAW,IAXO;AAYlB,cAAY,IAZM;AAalB,iBAAe,IAbG;AAclB,eAAa,IAdK;AAelB,uBAAqB,IAfH;AAgBlB,wBAAsB,IAhBJ;AAiBlB,WAAS,IAjBS;AAkBlB,UAAQ;AAlBU,EA3EF;AA+FjB,YAAW;AACV,kBAAgB;AADN,EA/FM;AAkGjB,eAAc;AACb,cAAY,IADC;AAEb,YAAU,IAFG;AAGb,cAAY,IAHC;AAIb,YAAU,IAJG;AAKb,aAAW;AALE;AAlGG,CAAlB;;AA2GA,IAAIC,aAAa,SAAbA,UAAa,CAACC,GAAD,EAAMC,GAAN,EAAc;AAC9B,KAAIC,YAAYF,GAAhB;AACA,KAAIG,SAASF,IAAIG,KAAJ,CAAU,GAAV,CAAb;;AAEA,QAAOD,OAAOE,MAAP,GAAgB,CAAvB,EAA0B;AACzB,MAAIC,eAAeH,OAAOI,KAAP,EAAnB;AACA,MAAI;AACHL,eAAYA,UAAUI,YAAV,CAAZ;AACA,GAFD,CAEE,OAAOE,CAAP,EAAU;AACX;AACA;AACD;AACD,QAAON,SAAP;AACA,CAbD;;AAeA,IAAIO,YAAY,SAAZA,SAAY,CAAUR,GAAV,EAAeS,GAAf,EAAoBC,IAApB,EAA0B;AACzC,SAAQA,IAAR;;AAEA,OAAK,YAAL;AACC,OAAIC,QAAQC,OAAOC,IAAP,CAAYlB,MAAMmB,SAAlB,CAAZ;AACA,OAAIH,MAAMI,OAAN,CAAcN,GAAd,IAAqB,CAAzB,EAA4B;AAC3B,UAAM,IAAIO,SAAJ,CAAc,uBAAuBhB,GAAvB,GAA6B,yBAA7B,GAAyDW,MAAMM,IAAN,CAAW,IAAX,CAAvE,CAAN;AACA;AACD;;AAED,OAAK,YAAL;AACCtB,SAAMuB,SAAN,CAAgBC,QAAhB,CAAyBV,GAAzB;AACA;;AAED,OAAK,aAAL;AACCd,SAAMyB,WAAN,CAAkBD,QAAlB,CAA2BV,GAA3B;AACA;;AAED,OAAK,4BAAL;AACCd,SAAM0B,wBAAN,CAA+BF,QAA/B,CAAwCV,GAAxC;AACA;;AAED,OAAK,eAAL;AACCd,SAAM2B,WAAN,CAAkBH,QAAlB,CAA2BV,GAA3B;AACA;;AAED,OAAK,aAAL;AACCd,SAAM4B,UAAN,CAAiBJ,QAAjB,CAA0BV,GAA1B;AACA;;AAED,OAAK,MAAL;AACCd,SAAM6B,IAAN,CAAWL,QAAX,CAAoBV,GAApB;AACA;;AAED,OAAK,YAAL;AACCd,SAAM8B,SAAN,CAAgBN,QAAhB,CAAyBV,GAAzB;AACA;;AAED,OAAK,SAAL;AACC,OAAI,CAAC,IAAD,EAAO,KAAP,EAAc,CAAd,EAAiB,CAAjB,EAAoBM,OAApB,CAA4BN,GAA5B,IAAmC,CAAvC,EAA0C;AACzC,UAAM,IAAIO,SAAJ,CAAchB,MAAM,uCAApB,CAAN;AACA;AACD;;AAED,OAAK,OAAL;AACC,OAAI0B,WAAWjB,GAAX,MAAoBA,GAAxB,EAA6B;AAC5B,UAAM,IAAIO,SAAJ,CAAchB,MAAM,kCAApB,CAAN;AACA;AACD;;AAED,OAAK,SAAL;AACC,OAAI2B,SAASlB,GAAT,MAAkBA,GAAtB,EAA2B;AAC1B,UAAM,IAAIO,SAAJ,CAAchB,MAAM,8BAApB,CAAN;AACA;AACD;;AAED,OAAK,QAAL;AACC,OAAI,OAAOS,GAAP,KAAe,QAAnB,EAA6B;AAC5B,UAAM,IAAIO,SAAJ,CAAchB,MAAM,4BAApB,CAAN;AACA;AACD;;AAED;AACC;AA9DD;AAgEA,CAjED;;AAmEA,IAAI4B,WAAW,SAAXA,QAAW,CAAUC,CAAV,EAAaC,QAAb,EAAuBC,IAAvB,EAA6B;AAC3C,MAAK,IAAIC,CAAT,IAAcH,CAAd,EAAiB;AAChB,MAAII,eAAeH,SAASI,MAAT,CAAgBF,CAAhB,CAAnB;AACA,MAAIG,UAAUF,aAAahB,IAAb,CAAkB,GAAlB,CAAd;AACA,MAAImB,WAAWtC,WAAWD,SAAX,EAAsBsC,OAAtB,CAAf;;AAEA,MAAI,OAAOC,QAAP,KAAoB,QAAxB,EAAkC;AACjC,OAAIC,WAAWR,EAAEG,CAAF,CAAf;AACAD,QAAKI,OAAL,EAAcE,QAAd,EAAwBD,QAAxB;AACA;AACD,MAAIP,EAAEG,CAAF,MAAS,IAAT,IAAiB,QAAOH,EAAEG,CAAF,CAAP,MAAgB,QAArC,EAA+C;AAC9CJ,YAASC,EAAEG,CAAF,CAAT,EAAeC,YAAf,EAA6BF,IAA7B;AACA;AACD;AACD,CAdD;;AAgBAO,OAAOC,OAAP,GAAiB,UAACC,IAAD,EAAU;AAC1BZ,UAASY,IAAT,EAAe,EAAf,EAAmBhC,SAAnB;AACA,CAFD","file":"optsValidator.js","sourcesContent":["const types = require('../types/index.js');\n\nconst optsTypes = {\n\t'margins': {\n\t\t'bottom': 'Float',\n\t\t'footer': 'Float',\n\t\t'header': 'Float',\n\t\t'left': 'Float',\n\t\t'right': 'Float',\n\t\t'top': 'Float'\n\t},\n\t'printOptions': {\n\t\t'centerHorizontal': 'Boolean',\n\t\t'centerVertical': 'Boolean',\n\t\t'printGridLines': 'Boolean',\n\t\t'printHeadings': 'Boolean'\n\n\t},\n\t'pageSetup': {\n\t\t'blackAndWhite': 'Boolean',\n\t\t'cellComments': 'CELL_COMMENTS',\n\t\t'copies': 'Integer',\n\t\t'draft': 'Boolean',\n\t\t'errors': 'PRINT_ERROR',\n\t\t'firstPageNumber': 'Boolean',\n\t\t'fitToHeight': 'Integer',\n\t\t'fitToWidth': 'Integer',\n\t\t'horizontalDpi': 'Integer',\n\t\t'orientation': 'ORIENTATION',\n\t\t'pageOrder': 'PAGE_ORDER',\n\t\t'paperHeight': 'POSITIVE_UNIVERSAL_MEASURE',\n\t\t'paperSize': 'PAPER_SIZE',\n\t\t'paperWidth': 'POSITIVE_UNIVERSAL_MEASURE',\n\t\t'scale': 'Integer',\n\t\t'useFirstPageNumber': 'Boolean',\n\t\t'usePrinterDefaults': 'Boolean',\n\t\t'verticalDpi': 'Integer'\n\t},\n\t'headerFooter': {\n\t\t'evenFooter': 'String',\n\t\t'evenHeader': 'String',\n\t\t'firstFooter': 'String',\n\t\t'firstHeader': 'String',\n\t\t'oddFooter': 'String',\n\t\t'oddHeader': 'String',\n\t\t'alignWithMargins': 'Boolean',\n\t\t'differentFirst': 'Boolean',\n\t\t'differentOddEven': 'Boolean',\n\t\t'scaleWithDoc': 'Boolean'\n\t},\n\t'sheetView': {\n\t\t'pane': {\n\t\t\t'activePane': 'PANE',\n\t\t\t'state': 'PANE_STATE',\n\t\t\t'topLeftCell': null,\n\t\t\t'xSplit': null,\n\t\t\t'ySplit': null\n\t\t},\n\t\t'tabSelected': null,\n\t\t'workbookViewId': null,\n\t\t'rightToLeft': null,\n\t\t'zoomScale': null,\n\t\t'zoomScaleNormal': null,\n\t\t'zoomScalePageLayoutView': null,\n\t\t'showGridLines': null\n\t},\n\t'sheetFormat': {\n\t\t'baseColWidth': null,\n\t\t'customHeight': null,\n\t\t'defaultColWidth': null,\n\t\t'defaultRowHeight': null,\n\t\t'outlineLevelCol': null,\n\t\t'outlineLevelRow': null,\n\t\t'thickBottom': null,\n\t\t'thickTop': null,\n\t\t'zeroHeight': null\n\t},\n\t'sheetProtection': {\n\t\t'autoFilter': null,\n\t\t'deleteColumns': null,\n\t\t'deleteRow': null,\n\t\t'formatCells': null,\n\t\t'formatColumns': null,\n\t\t'formatRows': null,\n\t\t'hashValue': null,\n\t\t'insertColumns': null,\n\t\t'insertHyperlinks': null,\n\t\t'insertRows': null,\n\t\t'objects': null,\n\t\t'password': null,\n\t\t'pivotTables': null,\n\t\t'scenarios': null,\n\t\t'selectLockedCells': null,\n\t\t'selectUnlockedCell': null,\n\t\t'sheet': null,\n\t\t'sort': null\n\t},\n\t'outline': {\n\t\t'summaryBelow': null\n\t},\n\t'autoFilter': {\n\t\t'startRow': null,\n\t\t'endRow': null,\n\t\t'startCol': null,\n\t\t'endCol': null,\n\t\t'filters': null\n\t}\n};\n\nlet getObjItem = (obj, key) => {\n\tlet returnObj = obj;\n\tlet levels = key.split('.');\n\n\twhile (levels.length > 0) {\n\t\tlet thisLevelKey = levels.shift();\n\t\ttry {\n\t\t\treturnObj = returnObj[thisLevelKey];\n\t\t} catch (e) {\n\t\t\t//returnObj = undefined;\n\t\t}\n\t}\n\treturn returnObj;\n};\n\nlet validator = function (key, val, type) {\n\tswitch (type) {\n\n\tcase 'PAPER_SIZE':\n\t\tlet sizes = Object.keys(types.paperSize);\n\t\tif (sizes.indexOf(val) < 0) {\n\t\t\tthrow new TypeError('Invalid value for ' + key + '. Value must be one of ' + sizes.join(', '));\n\t\t}\n\t\tbreak;\n\n\tcase 'PAGE_ORDER':\n\t\ttypes.pageOrder.validate(val);\n\t\tbreak;\n\n\tcase 'ORIENTATION':\n\t\ttypes.orientation.validate(val);\n\t\tbreak;\n\n\tcase 'POSITIVE_UNIVERSAL_MEASURE':\n\t\ttypes.positiveUniversalMeasure.validate(val);\n\t\tbreak;\n\n\tcase 'CELL_COMMENTS':\n\t\ttypes.cellComment.validate(val);\n\t\tbreak;\n\n\tcase 'PRINT_ERROR':\n\t\ttypes.printError.validate(val);\n\t\tbreak;\n\n\tcase 'PANE':\n\t\ttypes.pane.validate(val);\n\t\tbreak;\n\n\tcase 'PANE_STATE':\n\t\ttypes.paneState.validate(val);\n\t\tbreak;\n\n\tcase 'Boolean':\n\t\tif ([true, false, 1, 0].indexOf(val) < 0) {\n\t\t\tthrow new TypeError(key + ' expects value of true, false, 1 or 0');\n\t\t}\n\t\tbreak;\n\n\tcase 'Float':\n\t\tif (parseFloat(val) !== val) {\n\t\t\tthrow new TypeError(key + ' expects value as a Float number');\n\t\t}\n\t\tbreak;\n\n\tcase 'Integer':\n\t\tif (parseInt(val) !== val) {\n\t\t\tthrow new TypeError(key + ' expects value as an Integer');\n\t\t}\n\t\tbreak;\n\n\tcase 'String':\n\t\tif (typeof val !== 'string') {\n\t\t\tthrow new TypeError(key + ' expects value as a String');\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n};\n\nlet traverse = function (o, keyParts, func) {\n\tfor (let i in o) {\n\t\tlet thisKeyParts = keyParts.concat(i);\n\t\tlet thisKey = thisKeyParts.join('.');\n\t\tlet thisType = getObjItem(optsTypes, thisKey);\n\n\t\tif (typeof thisType === 'string') {\n\t\t\tlet thisItem = o[i];\n\t\t\tfunc(thisKey, thisItem, thisType);\n\t\t}\n\t\tif (o[i] !== null && typeof o[i] === 'object') {\n\t\t\ttraverse(o[i], thisKeyParts, func);\n\t\t}\n\t}\n};\n\nmodule.exports = (opts) => {\n\ttraverse(opts, [], validator);\n};\n"]}