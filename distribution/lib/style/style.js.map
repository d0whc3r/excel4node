{"version":3,"sources":["../../../source/lib/style/style.js"],"names":["utils","require","_","Alignment","Border","Fill","Font","NumberFormat","Protection","_getFontId","wb","font","merge","opts","defaultFont","thisFont","lookupKey","JSON","stringify","toObject","id","styleDataLookup","fonts","undefined","styleData","push","_getFillId","fill","thisFill","fills","_getBorderId","border","thisBorder","borders","_getNumFmt","val","fmt","numFmts","forEach","f","isEqual","formatCode","fmtId","length","numFmtId","Style","alignment","borderId","fillId","fontId","numberFormat","numFmt","protection","locked","hidden","pivotButton","quotePrefix","ids","obj","ele","thisEle","thisXF","xf","Object","keys","a","addToXMLele","att","applyFont","applyFill","applyBorder","applyNumberFormat","applyAlignment","applyProtection","module","exports"],"mappings":"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","file":"style.js","sourcesContent":["const utils = require('../utils.js');\nconst _ = require('lodash');\n\nconst Alignment = require('./classes/alignment.js');\nconst Border = require('./classes/border.js');\nconst Fill = require('./classes/fill.js');\nconst Font = require('./classes/font.js');\nconst NumberFormat = require('./classes/numberFormat.js');\nconst Protection = require('./classes/protection.js');\n\nlet _getFontId = (wb, font) => {\n\n\t// Create the Font and lookup key\n\tfont = _.merge({}, wb.opts.defaultFont, font);\n\tconst thisFont = new Font(font);\n\tconst lookupKey = JSON.stringify(thisFont.toObject());\n\n\t// Find an existing entry, creating a new one if it does not exist\n\tlet id = wb.styleDataLookup.fonts[lookupKey];\n\tif (id === undefined) {\n\t\tid = wb.styleData.fonts.push(thisFont) - 1;\n\t\twb.styleDataLookup.fonts[lookupKey] = id;\n\t}\n\n\treturn id;\n};\n\nlet _getFillId = (wb, fill) => {\n\tif (fill === undefined) {\n\t\treturn null;\n\t}\n\n\t// Create the Fill and lookup key\n\tconst thisFill = new Fill(fill);\n\tconst lookupKey = JSON.stringify(thisFill.toObject());\n\n\t// Find an existing entry, creating a new one if it does not exist\n\tlet id = wb.styleDataLookup.fills[lookupKey];\n\tif (id === undefined) {\n\t\tid = wb.styleData.fills.push(thisFill) - 1;\n\t\twb.styleDataLookup.fills[lookupKey] = id;\n\t}\n\n\treturn id;\n};\n\nlet _getBorderId = (wb, border) => {\n\tif (border === undefined) {\n\t\treturn null;\n\t}\n\n\t// Create the Border and lookup key\n\tconst thisBorder = new Border(border);\n\tconst lookupKey = JSON.stringify(thisBorder.toObject());\n\n\t// Find an existing entry, creating a new one if it does not exist\n\tlet id = wb.styleDataLookup.borders[lookupKey];\n\tif (id === undefined) {\n\t\tid = wb.styleData.borders.push(thisBorder) - 1;\n\t\twb.styleDataLookup.borders[lookupKey] = id;\n\t}\n\n\treturn id;\n};\n\nlet _getNumFmt = (wb, val) => {\n\tlet fmt;\n\twb.styleData.numFmts.forEach((f) => {\n\t\tif (_.isEqual(f.formatCode, val)) {\n\t\t\tfmt = f;\n\t\t}\n\t});\n\n\tif (fmt === undefined) {\n\t\tlet fmtId = wb.styleData.numFmts.length + 164;\n\t\tfmt = new NumberFormat(val);\n\t\tfmt.numFmtId = fmtId;\n\t\twb.styleData.numFmts.push(fmt);\n\t}\n\n\treturn fmt;\n};\n\n\n/*\n    Style Opts\n    {\n        alignment: { // §18.8.1\n            horizontal: ['center', 'centerContinuous', 'distributed', 'fill', 'general', 'justify', 'left', 'right'],\n            indent: integer, // Number of spaces to indent = indent value * 3\n            justifyLastLine: boolean,\n            readingOrder: ['contextDependent', 'leftToRight', 'rightToLeft'],\n            relativeIndent: integer, // number of additional spaces to indent\n            shrinkToFit: boolean,\n            textRotation: integer, // number of degrees to rotate text counter-clockwise\n            vertical: ['bottom', 'center', 'distributed', 'justify', 'top'],\n            wrapText: boolean\n        },\n        font: { // §18.8.22\n            bold: boolean,\n            charset: integer,\n            color: string,\n            condense: boolean,\n            extend: boolean,\n            family: string,\n            italics: boolean,\n            name: string,\n            outline: boolean,\n            scheme: string, // §18.18.33 ST_FontScheme (Font scheme Styles)\n            shadow: boolean,\n            strike: boolean,\n            size: integer,\n            underline: boolean,\n            vertAlign: string // §22.9.2.17 ST_VerticalAlignRun (Vertical Positioning Location)\n        },\n        border: { // §18.8.4 border (Border)\n            left: {\n                style: string,\n                color: string\n            },\n            right: {\n                style: string,\n                color: string\n            },\n            top: {\n                style: string,\n                color: string\n            },\n            bottom: {\n                style: string,\n                color: string\n            },\n            diagonal: {\n                style: string,\n                color: string\n            },\n            diagonalDown: boolean,\n            diagonalUp: boolean,\n            outline: boolean\n        },\n        fill: { // §18.8.20 fill (Fill)\n            type: 'pattern',\n            patternType: 'solid',\n            color: 'Yellow'\n        },\n        numberFormat: integer or string, // §18.8.30 numFmt (Number Format)\n        protection: {\n            hidden: boolean, //Means formula is hidden if sheet is protected\n\t\t\t\t\t\tlocked: boolean  //Means cell is locked if sheet is protected\n        }\n    }\n*/\nclass Style {\n\tconstructor(wb, opts) {\n\t\t/**\n\t\t * Excel Style object\n\t\t * @class Style\n\t\t * @desc Style object for formatting Excel Cells\n\t\t * @param {Workbook} wb Excel Workbook object\n\t\t * @param {Object} opts Options for style\n\t\t * @param {Object} opts.alignment Options for creating an Alignment instance\n\t\t * @param {Object} opts.font Options for creating a Font instance\n\t\t * @param {Object} opts.border Options for creating a Border instance\n\t\t * @param {Object} opts.fill Options for creating a Fill instance\n\t\t * @param {Object} opts.protection Options for cell protection\n\t\t * @param {String} opts.numberFormat\n\t\t * @property {Alignment} alignment Alignment instance associated with Style\n\t\t * @property {Border} border Border instance associated with Style\n\t\t * @property {Number} borderId ID of Border instance in the Workbook\n\t\t * @property {Fill} fill Fill instance associated with Style\n\t\t * @property {Number} fillId ID of Fill instance in the Workbook\n\t\t * @property {Font} font Font instance associated with Style\n\t\t * @property {Number} fontId ID of Font instance in the Workbook\n\t\t * @property {String} numberFormat String represenation of the way a number should be formatted\n\t\t * @property {Object} protection Protection instance associated with Style\n\t\t * @property {Number} xf XF id of the Style in the Workbook\n\t\t * @returns {Style}\n\t\t */\n\t\topts = opts ? opts : {};\n\n\t\tif (opts.alignment !== undefined) {\n\t\t\tthis.alignment = new Alignment(opts.alignment);\n\t\t}\n\n\t\tif (opts.border !== undefined) {\n\t\t\tthis.borderId = _getBorderId(wb, opts.border); // attribute 0 based index\n\t\t\tthis.border = wb.styleData.borders[this.borderId];\n\t\t}\n\t\tif (opts.fill !== undefined) {\n\t\t\tthis.fillId = _getFillId(wb, opts.fill); // attribute 0 based index\n\t\t\tthis.fill = wb.styleData.fills[this.fillId];\n\t\t}\n\n\t\tif (opts.font !== undefined) {\n\t\t\tthis.fontId = _getFontId(wb, opts.font); // attribute 0 based index\n\t\t\tthis.font = wb.styleData.fonts[this.fontId];\n\t\t}\n\n\t\tif (opts.numberFormat !== undefined) {\n\t\t\tif (typeof opts.numberFormat === 'number' && opts.numberFormat <= 164) {\n\t\t\t\tthis.numFmtId = opts.numberFormat;\n\t\t\t} else if (typeof opts.numberFormat === 'string') {\n\t\t\t\tthis.numFmt = _getNumFmt(wb, opts.numberFormat);\n\t\t\t}\n\t\t}\n\n\t\tthis.protection = new Protection(opts.protection || {\n\t\t\tlocked: true,\n\t\t\thidden: false\n\t\t});\n\n\t\tif (opts.pivotButton !== undefined) {\n\t\t\tthis.pivotButton = null; // attribute boolean\n\t\t}\n\n\t\tif (opts.quotePrefix !== undefined) {\n\t\t\tthis.quotePrefix = null; // attribute boolean\n\t\t}\n\n\t\tthis.ids = {};\n\t}\n\n\tget xf() {\n\t\tlet thisXF = {};\n\n\t\tif (typeof this.fontId === 'number') {\n\t\t\tthisXF.applyFont = 1;\n\t\t\tthisXF.fontId = this.fontId;\n\t\t}\n\n\t\tif (typeof this.fillId === 'number') {\n\t\t\tthisXF.applyFill = 1;\n\t\t\tthisXF.fillId = this.fillId;\n\t\t}\n\n\t\tif (typeof this.borderId === 'number') {\n\t\t\tthisXF.applyBorder = 1;\n\t\t\tthisXF.borderId = this.borderId;\n\t\t}\n\n\t\tif (typeof this.numFmtId === 'number') {\n\t\t\tthisXF.applyNumberFormat = 1;\n\t\t\tthisXF.numFmtId = this.numFmtId;\n\t\t} else if (this.numFmt !== undefined && this.numFmt !== null) {\n\t\t\tthisXF.applyNumberFormat = 1;\n\t\t\tthisXF.numFmtId = this.numFmt.numFmtId;\n\t\t}\n\n\t\tif (this.alignment instanceof Alignment) {\n\t\t\tthisXF.applyAlignment = 1;\n\t\t\tthisXF.alignment = this.alignment;\n\t\t}\n\n\t\tif (this.protection) {\n\t\t\tthisXF.applyProtection = true;\n\t\t\tthisXF.protection = this.protection;\n\t\t}\n\n\t\treturn thisXF;\n\t}\n\n\n\t/**\n\t * @func Style.toObject\n\t * @desc Converts the Style instance to a javascript object\n\t * @returns {Object}\n\t */\n\ttoObject() {\n\t\tlet obj = {};\n\n\t\tif (typeof this.fontId === 'number') {\n\t\t\tobj.font = this.font.toObject();\n\t\t}\n\n\t\tif (typeof this.fillId === 'number') {\n\t\t\tobj.fill = this.fill.toObject();\n\t\t}\n\n\t\tif (typeof this.borderId === 'number') {\n\t\t\tobj.border = this.border.toObject();\n\t\t}\n\n\t\tif (typeof this.numFmtId === 'number' && this.numFmtId < 164) {\n\t\t\tobj.numberFormat = this.numFmtId;\n\t\t} else if (this.numFmt !== undefined && this.numFmt !== null) {\n\t\t\tobj.numberFormat = this.numFmt.formatCode;\n\t\t}\n\n\t\tif (this.alignment instanceof Alignment) {\n\t\t\tobj.alignment = this.alignment.toObject();\n\t\t}\n\n\t\tif (this.pivotButton !== undefined) {\n\t\t\tobj.pivotButton = this.pivotButton;\n\t\t}\n\n\t\tif (this.quotePrefix !== undefined) {\n\t\t\tobj.quotePrefix = this.quotePrefix;\n\t\t}\n\n\t\tif (this.protection !== undefined) {\n\t\t\tobj.protection = this.protection;\n\t\t}\n\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * @alias Style.addToXMLele\n\t * @desc When generating Workbook output, attaches style to the styles xml file\n\t * @func Style.addToXMLele\n\t * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n\t */\n\taddXFtoXMLele(ele) {\n\t\tlet thisEle = ele.ele('xf');\n\t\tlet thisXF = this.xf;\n\t\tObject.keys(thisXF).forEach((a) => {\n\t\t\tif (a === 'alignment' || a === 'protection') {\n\t\t\t\tthisXF[a].addToXMLele(thisEle);\n\t\t\t} else {\n\t\t\t\tthisEle.att(a, thisXF[a]);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * @alias Style.addDXFtoXMLele\n\t * @desc When generating Workbook output, attaches style to the styles xml file as a dxf for use with conditional formatting rules\n\t * @func Style.addDXFtoXMLele\n\t * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n\t */\n\taddDXFtoXMLele(ele) {\n\t\tlet thisEle = ele.ele('dxf');\n\n\t\tif (this.font instanceof Font) {\n\t\t\tthis.font.addToXMLele(thisEle);\n\t\t}\n\n\t\tif (this.numFmt instanceof NumberFormat) {\n\t\t\tthis.numFmt.addToXMLele(thisEle);\n\t\t}\n\n\t\tif (this.fill instanceof Fill) {\n\t\t\tthis.fill.addToXMLele(thisEle);\n\t\t}\n\n\t\tif (this.alignment instanceof Alignment) {\n\t\t\tthis.alignment.addToXMLele(thisEle);\n\t\t}\n\n\t\tif (this.border instanceof Border) {\n\t\t\tthis.border.addToXMLele(thisEle);\n\t\t}\n\t}\n}\n\nmodule.exports = Style;\n"]}